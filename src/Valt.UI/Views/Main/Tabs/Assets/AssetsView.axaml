<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:assets="clr-namespace:Valt.UI.Views.Main.Tabs.Assets"
             xmlns:models="clr-namespace:Valt.UI.Views.Main.Tabs.Assets.Models"
             xmlns:lang="clr-namespace:Valt.UI.Lang"
             xmlns:userControls="clr-namespace:Valt.UI.UserControls"
             mc:Ignorable="d" d:DesignWidth="1300" d:DesignHeight="650"
             x:Class="Valt.UI.Views.Main.Tabs.Assets.AssetsView"
             x:DataType="assets:AssetsViewModel">
    <Design.DataContext>
        <x:Static Member="assets:AssetsViewModel.DesignTimeSample" />
    </Design.DataContext>

    <!-- Card border styling based on selection/hover state -->
    <UserControl.Styles>
        <Style Selector="Border.AssetCard">
            <Setter Property="BorderBrush" Value="{DynamicResource AssetCardBorderBrush}" />
        </Style>
        <Style Selector="Border.AssetCard:pointerover">
            <Setter Property="BorderBrush" Value="{DynamicResource AssetCardBorderHoverBrush}" />
        </Style>
        <Style Selector="Border.AssetCard.selected">
            <Setter Property="BorderBrush" Value="{DynamicResource AssetCardBorderSelectedBrush}" />
        </Style>
    </UserControl.Styles>

    <Grid MinHeight="500">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="350" />
        </Grid.ColumnDefinitions>

        <!-- Main Assets List -->
        <Border Grid.Column="0" Padding="15">
            <Grid RowDefinitions="50, *">
                <!-- Header Row with Add Button -->
                <Grid Grid.Row="0" ColumnDefinitions="Auto, Auto, *, Auto" VerticalAlignment="Center">
                    <TextBlock Grid.Column="0"
                               Text="{x:Static lang:language.Main_Assets}"
                               FontSize="{DynamicResource FontSizeXLarge}"
                               FontWeight="SemiBold"
                               VerticalAlignment="Center" />
                    <userControls:ModuleHelperText Grid.Column="1" VerticalAlignment="Center" Margin="8,0,0,0">
                        <userControls:ModuleHelperText.HelpContent>
                            <StackPanel Spacing="8" MaxWidth="320">
                                <TextBlock FontWeight="Bold" FontSize="{DynamicResource FontSizeMedium}"
                                           Text="{x:Static lang:language.Assets_Help_Title}" />
                                <TextBlock TextWrapping="Wrap"
                                           Text="{x:Static lang:language.Assets_Help_Description}" />
                                <StackPanel Spacing="2">
                                    <TextBlock FontWeight="SemiBold"
                                               Text="{x:Static lang:language.Assets_Help_NetWorth}" />
                                    <TextBlock TextWrapping="Wrap"
                                               Text="{x:Static lang:language.Assets_Help_NetWorthDescription}" />
                                </StackPanel>
                                <StackPanel Spacing="2">
                                    <TextBlock FontWeight="SemiBold"
                                               Text="{x:Static lang:language.Assets_Help_Selling}" />
                                    <TextBlock TextWrapping="Wrap"
                                               Text="{x:Static lang:language.Assets_Help_SellingDescription}" />
                                </StackPanel>
                            </StackPanel>
                        </userControls:ModuleHelperText.HelpContent>
                    </userControls:ModuleHelperText>
                    <StackPanel Grid.Column="3" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button Command="{Binding RefreshPricesCommand}"
                                Classes="transparent"
                                IsEnabled="{Binding !IsRefreshingPrices}"
                                ToolTip.Tip="{x:Static lang:language.Assets_RefreshPrices}">
                            <Panel>
                                <!-- Normal refresh icon (shown when not refreshing) -->
                                <TextBlock Text="&#xE5D5;"
                                           FontFamily="{StaticResource MaterialDesign}"
                                           FontSize="18"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           IsVisible="{Binding !IsRefreshingPrices}" />
                                <!-- Sync icon rotated (shown when refreshing) -->
                                <TextBlock Text="&#xE8DF;"
                                           FontFamily="{StaticResource MaterialDesign}"
                                           FontSize="18"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Opacity="0.6"
                                           IsVisible="{Binding IsRefreshingPrices}" />
                            </Panel>
                        </Button>
                        <Button Command="{Binding AddAssetCommand}"
                                Content="{x:Static lang:language.Assets_Add}" />
                    </StackPanel>
                </Grid>

                <!-- Assets Cards -->
                <Border Grid.Row="1"
                        Background="{DynamicResource Background700Brush}"
                        BorderBrush="{DynamicResource Background500Brush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Margin="0,10,0,0"
                        IsVisible="{Binding !IsLoading}">
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Auto"
                                  Padding="12">
                        <ItemsControl x:Name="AssetsItemsControl"
                                      ItemsSource="{Binding Assets}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="models:AssetViewModel">
                                <!-- Asset Card -->
                                <Border Width="230"
                                        Height="299"
                                        Margin="0,0,12,12"
                                        CornerRadius="4"
                                        BorderThickness="1"
                                        Classes="AssetCard"
                                        Classes.selected="{Binding IsSelected}"
                                        Background="{DynamicResource AssetCardBackgroundBrush}"
                                        ClipToBounds="True"
                                        Cursor="Hand"
                                        Opacity="{Binding Visible, Converter={StaticResource BoolToOpacityConverter}}"
                                        PointerPressed="AssetCard_PointerPressed">
                                    <Border.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="{x:Static lang:language.Assets_Edit}"
                                                      Command="{Binding $parent[UserControl].((assets:AssetsViewModel)DataContext).EditAssetCommand}"
                                                      CommandParameter="{Binding}" />
                                            <MenuItem Header="{x:Static lang:language.Assets_Delete}"
                                                      Command="{Binding $parent[UserControl].((assets:AssetsViewModel)DataContext).DeleteAssetCommand}"
                                                      CommandParameter="{Binding}" />
                                            <MenuItem Header="{x:Static lang:language.Assets_Sell}"
                                                      Command="{Binding $parent[UserControl].((assets:AssetsViewModel)DataContext).SellAssetCommand}"
                                                      CommandParameter="{Binding}" />
                                            <Separator />
                                            <MenuItem Header="{x:Static lang:language.Assets_ToggleVisibility}"
                                                      Command="{Binding $parent[UserControl].((assets:AssetsViewModel)DataContext).ToggleVisibilityCommand}"
                                                      CommandParameter="{Binding}" />
                                            <MenuItem Header="{x:Static lang:language.Assets_ToggleNetWorth}"
                                                      Command="{Binding $parent[UserControl].((assets:AssetsViewModel)DataContext).ToggleIncludeInNetWorthCommand}"
                                                      CommandParameter="{Binding}" />
                                        </ContextMenu>
                                    </Border.ContextMenu>
                                    <!-- Card Content -->
                                    <Grid RowDefinitions="50, *">
                                        <!-- Title Bar -->
                                        <Border Grid.Row="0"
                                                Background="{Binding TitleBarColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                Padding="12, 4">
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="{Binding Name}"
                                                           FontSize="{DynamicResource FontSizeMedium}"
                                                           FontWeight="SemiBold"
                                                           Foreground="{Binding TitleBarTextColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                           TextTrimming="CharacterEllipsis" />
                                                <TextBlock Text="{Binding AssetTypeName}"
                                                           FontSize="{DynamicResource FontSizeSmall}"
                                                           Foreground="{Binding TitleBarTextColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                           Opacity="0.8" />
                                            </StackPanel>
                                        </Border>

                                        <!-- Main Content -->
                                        <Border Grid.Row="1" Padding="12,8" Background="{DynamicResource Background900Brush}">
                                            <Grid RowDefinitions="*, Auto, Auto">
                                                <!-- Type-specific content -->
                                                <StackPanel Grid.Row="0" Spacing="4">
                                                <!-- Basic Asset content (Stock, ETF, Crypto, Commodity, Custom) -->
                                                <StackPanel Spacing="4" IsVisible="{Binding IsBasicAsset}">
                                                    <Grid ColumnDefinitions="Auto, *" IsVisible="{Binding Symbol, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Symbol}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,8,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding Symbol}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <Grid ColumnDefinitions="Auto, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Quantity}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,8,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding QuantityFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <Grid ColumnDefinitions="Auto, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Price}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,8,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding CurrentPriceFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <StackPanel Spacing="2" IsVisible="{Binding HasAcquisitionData}">
                                                        <Grid ColumnDefinitions="Auto, *">
                                                            <TextBlock Grid.Column="0"
                                                                       Text="{x:Static lang:language.Assets_Card_PnL}"
                                                                       FontSize="{DynamicResource FontSizeSmall}"
                                                                       Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                       Margin="0,0,8,0" />
                                                            <TextBlock Grid.Column="1"
                                                                       Text="{Binding PnLFormatted}"
                                                                       FontSize="{DynamicResource FontSizeSmall}"
                                                                       FontWeight="SemiBold"
                                                                       Foreground="{Binding PnLColor, Converter={StaticResource StringToColorBrushConverter}}" />
                                                        </Grid>
                                                        <TextBlock Text="{Binding PnLPercentageFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{Binding PnLColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                                   HorizontalAlignment="Right" />
                                                    </StackPanel>
                                                </StackPanel>

                                                <!-- Real Estate content -->
                                                <StackPanel Spacing="4" IsVisible="{Binding IsRealEstate}">
                                                    <TextBlock Text="{Binding Address}"
                                                               FontSize="{DynamicResource FontSizeSmall}"
                                                               Foreground="{DynamicResource AssetCardTextBrush}"
                                                               TextWrapping="Wrap"
                                                               MaxLines="2"
                                                               IsVisible="{Binding Address, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                                                    <Grid ColumnDefinitions="Auto, *" IsVisible="{Binding MonthlyRentalIncome, Converter={x:Static ObjectConverters.IsNotNull}}">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Rent}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,8,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding MonthlyRentalIncomeFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <StackPanel Spacing="2" IsVisible="{Binding HasAcquisitionData}">
                                                        <Grid ColumnDefinitions="Auto, *">
                                                            <TextBlock Grid.Column="0"
                                                                       Text="{x:Static lang:language.Assets_Card_PnL}"
                                                                       FontSize="{DynamicResource FontSizeSmall}"
                                                                       Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                       Margin="0,0,8,0" />
                                                            <TextBlock Grid.Column="1"
                                                                       Text="{Binding PnLFormatted}"
                                                                       FontSize="{DynamicResource FontSizeSmall}"
                                                                       FontWeight="SemiBold"
                                                                       Foreground="{Binding PnLColor, Converter={StaticResource StringToColorBrushConverter}}" />
                                                        </Grid>
                                                        <TextBlock Text="{Binding PnLPercentageFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{Binding PnLColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                                   HorizontalAlignment="Right" />
                                                    </StackPanel>
                                                </StackPanel>

                                                <!-- Leveraged Position content -->
                                                <StackPanel Spacing="3" IsVisible="{Binding IsLeveragedPosition}">
                                                    <Grid ColumnDefinitions="*, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{Binding PositionDirection}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding LeverageFormatted}"
                                                                   FontSize="{DynamicResource FontSizeSmall}"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}"
                                                                   HorizontalAlignment="Right" />
                                                    </Grid>
                                                    <Grid ColumnDefinitions="Auto, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Entry}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,4,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding EntryPriceFormatted}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <Grid ColumnDefinitions="Auto, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Liquidation}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,4,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding LiquidationPriceFormatted}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <Grid ColumnDefinitions="Auto, *">
                                                        <TextBlock Grid.Column="0"
                                                                   Text="{x:Static lang:language.Assets_Card_Distance}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardLabelBrush}"
                                                                   Margin="0,0,4,0" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding DistanceToLiquidationFormatted}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="{DynamicResource AssetCardTextBrush}" />
                                                    </Grid>
                                                    <TextBlock Text="{Binding PnLPercentageFormatted}"
                                                               FontSize="{DynamicResource FontSizeSmall}"
                                                               FontWeight="SemiBold"
                                                               Foreground="{Binding PnLColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                               HorizontalAlignment="Right"
                                                               Margin="0,4,0,0" />
                                                    <Border Background="{DynamicResource SemanticNegative500Brush}"
                                                            CornerRadius="4"
                                                            Padding="6,2"
                                                            HorizontalAlignment="Center"
                                                            IsVisible="{Binding IsAtRisk}">
                                                        <TextBlock Text="{x:Static lang:language.Assets_Card_AtRisk}"
                                                                   FontSize="{DynamicResource FontSizeXSmall}"
                                                                   Foreground="White"
                                                                   FontWeight="Bold" />
                                                    </Border>
                                                </StackPanel>
                                            </StackPanel>

                                                <!-- Value display -->
                                                <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                                    <Border Height="1" Background="{DynamicResource AssetCardSeparatorBrush}" Margin="0,0,0,8" />
                                                    <TextBlock Text="{Binding DisplayValueFormatted}"
                                                               FontSize="{DynamicResource FontSizeLarge}"
                                                               FontWeight="Bold"
                                                               Foreground="{Binding ValueColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                               HorizontalAlignment="Center" />
                                                </StackPanel>

                                                <!-- NetWorth indicator (integrated into body) -->
                                                <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="4"
                                                            HorizontalAlignment="Center" Margin="0,8,0,4">
                                                    <TextBlock Text="{Binding NetWorthIcon}"
                                                               FontFamily="{StaticResource MaterialDesign}"
                                                               FontSize="14"
                                                               Foreground="{Binding NetWorthIconColor, Converter={StaticResource StringToColorBrushConverter}}"
                                                               VerticalAlignment="Center" />
                                                    <TextBlock Text="{x:Static lang:language.Assets_Card_NetWorth}"
                                                               FontSize="{DynamicResource FontSizeXSmall}"
                                                               Foreground="{DynamicResource AssetCardMutedBrush}"
                                                               VerticalAlignment="Center" />
                                                    <TextBlock Text="{Binding VisibilityIcon}"
                                                               FontFamily="{StaticResource MaterialDesign}"
                                                               FontSize="14"
                                                               Foreground="{DynamicResource AssetCardMutedBrush}"
                                                               VerticalAlignment="Center"
                                                               Margin="8,0,0,0"
                                                               IsVisible="{Binding !Visible}" />
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>

                <TextBlock Grid.Row="1"
                           Text="{x:Static lang:language.Loading}"
                           FontSize="{DynamicResource FontSizeMedium}"
                           Foreground="{DynamicResource Text400Brush}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           IsVisible="{Binding IsLoading}" />
            </Grid>
        </Border>

        <!-- Summary Panel -->
        <Border Grid.Column="1" Padding="15">
            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                <StackPanel Orientation="Vertical" Spacing="15">
                    <!-- Summary Card -->
                    <Border Background="{DynamicResource Background700Brush}"
                            BorderBrush="{DynamicResource Background500Brush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="16">
                        <StackPanel Spacing="12" IsVisible="{Binding !IsSecureModeEnabled}">
                            <TextBlock Text="{x:Static lang:language.Assets_Summary_Title}"
                                       FontSize="{DynamicResource FontSizeLarge}"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8" />

                            <Grid ColumnDefinitions="*, Auto">
                                <TextBlock Grid.Column="0"
                                           Text="{x:Static lang:language.Assets_Summary_TotalAssets}"
                                           FontSize="{DynamicResource FontSizeMedium}"
                                           Foreground="{DynamicResource Text400Brush}"
                                           VerticalAlignment="Center" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding Summary.TotalAssets}"
                                           FontSize="{DynamicResource FontSizeLarge}"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center" />
                            </Grid>

                            <Grid ColumnDefinitions="*, Auto">
                                <TextBlock Grid.Column="0"
                                           Text="{x:Static lang:language.Assets_Summary_InNetWorth}"
                                           FontSize="{DynamicResource FontSizeMedium}"
                                           Foreground="{DynamicResource Text400Brush}"
                                           VerticalAlignment="Center" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding Summary.AssetsIncludedInNetWorth}"
                                           FontSize="{DynamicResource FontSizeLarge}"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center" />
                            </Grid>

                            <Separator Margin="0,8" />

                            <Grid ColumnDefinitions="*, Auto">
                                <TextBlock Grid.Column="0"
                                           Text="{x:Static lang:language.Assets_Summary_TotalValue}"
                                           FontSize="{DynamicResource FontSizeMedium}"
                                           Foreground="{DynamicResource Text400Brush}"
                                           VerticalAlignment="Center" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding TotalValueFormatted}"
                                           Foreground="{Binding TotalValueColor}"
                                           FontSize="{DynamicResource FontSizeXLarge}"
                                           FontWeight="SemiBold"
                                           FontFamily="{StaticResource GeistMono}"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center" />
                            </Grid>

                            <Grid ColumnDefinitions="*, Auto">
                                <TextBlock Grid.Column="0"
                                           Text="{x:Static lang:language.Assets_Summary_TotalSats}"
                                           FontSize="{DynamicResource FontSizeMedium}"
                                           Foreground="{DynamicResource Text400Brush}"
                                           VerticalAlignment="Center" />
                                <TextBlock Grid.Column="1"
                                           Text="{Binding Summary.TotalValueInSats, StringFormat='{}{0:N0} sats'}"
                                           Foreground="{Binding TotalSatsColor}"
                                           FontSize="{DynamicResource FontSizeLarge}"
                                           FontWeight="SemiBold"
                                           FontFamily="{StaticResource GeistMono}"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center" />
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Secure Mode Placeholder -->
                    <TextBlock Text="---"
                               FontSize="{DynamicResource FontSizeMedium}"
                               Foreground="{DynamicResource Text400Brush}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               IsVisible="{Binding IsSecureModeEnabled}" />

                    <!-- Selected Asset Details -->
                    <Border Background="{DynamicResource Background700Brush}"
                            BorderBrush="{DynamicResource Background500Brush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="16"
                            IsVisible="{Binding SelectedAsset, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Spacing="12">
                            <TextBlock Text="{x:Static lang:language.Assets_Details_Title}"
                                       FontSize="{DynamicResource FontSizeLarge}"
                                       FontWeight="SemiBold"
                                       Margin="0,0,0,8" />

                            <TextBlock Text="{Binding SelectedAsset.Name}"
                                       FontSize="{DynamicResource FontSizeXLarge}"
                                       FontWeight="Bold" />

                            <TextBlock Text="{Binding SelectedAsset.AssetTypeName}"
                                       FontSize="{DynamicResource FontSizeMedium}"
                                       Foreground="{DynamicResource Text400Brush}" />

                            <!-- Leveraged Position Details -->
                            <StackPanel Spacing="8" IsVisible="{Binding SelectedAsset.IsLeveragedPosition}">
                                <Separator Margin="0,4" />

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_Leverage}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.LeverageFormatted}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_EntryPrice}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.EntryPriceFormatted}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_Collateral}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.CollateralFormatted}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_Liquidation}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.LiquidationPriceFormatted}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_DistanceToLiq}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.DistanceToLiquidationFormatted}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_PnL}" />
                                    <TextBlock Grid.Column="1"
                                               Text="{Binding SelectedAsset.PnLFormatted}"
                                               Foreground="{Binding SelectedAsset.PnLColor}"
                                               FontWeight="SemiBold" />
                                </Grid>

                                <Border Background="{DynamicResource SemanticNegative500Brush}"
                                        CornerRadius="4"
                                        Padding="8,4"
                                        IsVisible="{Binding SelectedAsset.IsAtRisk}">
                                    <TextBlock Text="{x:Static lang:language.Assets_AtRisk}"
                                               Foreground="White"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center" />
                                </Border>
                            </StackPanel>

                            <!-- Real Estate Details -->
                            <StackPanel Spacing="8" IsVisible="{Binding SelectedAsset.IsRealEstate}">
                                <Separator Margin="0,4" />

                                <Grid ColumnDefinitions="*, Auto" IsVisible="{Binding SelectedAsset.Address, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_Address}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.Address}" FontWeight="SemiBold" />
                                </Grid>

                                <Grid ColumnDefinitions="*, Auto" IsVisible="{Binding SelectedAsset.MonthlyRentalIncome, Converter={x:Static ObjectConverters.IsNotNull}}">
                                    <TextBlock Grid.Column="0" Text="{x:Static lang:language.Assets_RentalIncome}" />
                                    <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.MonthlyRentalIncomeFormatted}" FontWeight="SemiBold" />
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
